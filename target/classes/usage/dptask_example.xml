<?xml version="1.0" encoding="UTF-8"?>
<!-- *******************************************************************
	**
	** NAME
	** ant.simple.example.xml
	**
	** PURPOSE
	** This file is an example ANT build script for deployment to
	** DataPower XML acceleration devices.
	**
	** PARMS
	** To use the deploy targets locally, the following parameters should be supplied as a minimum:
	** hostname     == Device to deploy to. 
	** userName, userPassword == User credentials
	** service.name    == name of services to deploy - correlates to a deployable <serviceName>.zip (or xml) file in teh staging.dir.
	** domain       == Working domain (default is '<service.name>' domain)
	** staging.dir     == Staging dir contains the built deployment artifacts, this will be a temporary buildforge working directory
	**
	** OPTIONAL PARMS - Deployment
    ** source.type     == ZIP or XML (default is 'ZIP')
	**
	******************************************************************** -->
<project name="dp-deploy" default="deploy">
	
	<!-- *****************************************************************
		** Parameters : may be overridden from a properties file or via cmdLine
		****************************************************************** -->
	<!-- Default Environment -->
	<property name="environment" value="DEV"/>
	
	<!-- Location of optional properties file -->
	<property file="deployment.properties"/>
	<property file="${environment}.properties"/>
	
	<!-- Device parameters -->
	<property name="dp.soma.port"  value="5550"/>
	<property name="domain" value="${service.name}"/>
	
	<!-- Deployment parameters -->
	<property name="source.type" value="ZIP"/>
	<property name="verbose" value="false"/>

	<!-- Default locations -->
	<property name="lib.dir"  value="C:\\Dev\\DPDIRECT_PROJECT\\dpdirect-ant-task/lib"/>
	
	<!-- *****************************************************************
		** Set up the "DPDirect" task library
		****************************************************************** -->
	<path id="dpdirect.class.path">
		<!-- classpath for the dpdirect task -->
		<pathelement location="dpdirect-1.1.0.jar"/>
		<pathelement location="${lib.dir}/xercesImpl.jar"/>
		<pathelement location="${lib.dir}/log4j.jar"/>
	</path>
	<taskdef name="dpDeploy" classname="org.dpdirect.dpmgmt.DPDirectTask" classpathref="dpdirect.class.path"/>
	
	
	<!-- **********************************************************
		** target: deploy.all
		**
		** PURPOSE
		** Deploy all objects in the ${service.name}.ZIP file to each dp device, and also
		** deploy all service files in the 'src' dir to the local:///${service.name} path
		****************************************************************** -->
	<target name="deploy">
		<dpDeploy domain="${domain}" 
			hostname="${hostname}" firmware="5" verbose="${verbose}">
			<operation name="GetDomainStatusRequest" domain="EXISTK-TEST">
				<option name="Domain" value="EXISTK-TEST"/>
			</operation>
			<operation name="get-status">
				<option name="domain" value="EXISTK-TEST"/>
				<option name="class" value="ActiveUsers"/>
			</operation>
			<operation name="SaveConfig">
				<option name="domain" value="EXISTK-TEST"/>
			</operation>
		</dpDeploy>
	</target>
	
</project>
